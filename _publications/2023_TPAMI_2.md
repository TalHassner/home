---
title: "Reverse engineering of generative models: Inferring model hyperparameters from generated images"
collection: publications
permalink: /publication/2023_TPAMI_2
excerpt: '[<font color="SkyBlue"><i>arXiv preprint</i></font>](https://arxiv.org/pdf/2106.07873.pdf)'
date: 2023-08-02
venue: 'IEEE Transactions on Pattern Analysis and Machine Intelligence'
paperurl: ''
citation: 'Vishal Asnani, Xi Yin, Tal Hassner, Xiaoming Liu, <i>Reverse engineering of generative models: Inferring model hyperparameters from generated images.</i> IEEE Transactions on Pattern Analysis and Machine Intelligence. Accepted, Aug. 2023.'
---

<img src='https://github.com/vishal3477/Reverse_Engineering_GMs/raw/main/image/teaser_resized.png'><br/>
<b>Top:</b> Three increasingly difficult tasks: (a) *deepfake detection* classifies an image as genuine or fake; (b) *image attribution* predicts which of a closed set of GMs generated a fake image; and (c) *model parsing*, proposed here, infers hyperparameters of the GM used to generate an image, for those models unseen during training. <b>Bottom</b>: We present a framework for model parsing, which can also be applied to simpler tasks of deepfake detection and image attribution.


### Abstract
State-of-the-art (SOTA) Generative Models (GMs) can synthesize photo-realistic images that are hard for humans to distinguish from genuine photos. Identifying and understanding manipulated media are crucial to mitigate the social concerns on the potential misuse of GMs. We propose to perform reverse engineering of GMs to infer model hyperparameters from the images generated by these models. We define a novel problem, "model parsing", as estimating GM network architectures and training loss functions by examining their generated images -- a task seemingly impossible for human beings. To tackle this problem, we propose a framework with two components: a Fingerprint Estimation Network (FEN), which estimates a GM fingerprint from a generated image by training with four constraints to encourage the fingerprint to have desired properties, and a Parsing Network (PN), which predicts network architecture and loss functions from the estimated fingerprints. To evaluate our approach, we collect a fake image dataset with 100K images generated by 116 different GMs. Extensive experiments show encouraging results in parsing the hyperparameters of the unseen models. Finally, our fingerprint estimation can be leveraged for deepfake detection and image attribution, as we show by reporting SOTA results on both the deepfake detection (Celeb-DF) and image attribution benchmarks.


[Paper from IEEE](https://www.computer.org/csdl/journal/tp/5555/01/10202583/1PhSMobmlUs)

[arXiv preprint](https://arxiv.org/abs/2106.07873)

[Project page and with generative model collection](https://github.com/vishal3477/Reverse_Engineering_GMs)

[Meta AI research blog post](https://ai.meta.com/blog/reverse-engineering-generative-model-from-a-single-deepfake-image/) 


### Public media coverage:
<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/CNBC_logo.svg/701px-CNBC_logo.svg.png)](https://www.cnbc.com/2021/06/16/facebook-scientists-say-they-can-tell-where-deepfakes-come-from.html "CNBC") -->

<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/CNET_%282022%29.svg/220px-CNET_%282022%29.svg.png)](https://www.cnet.com/news/privacy/facebook-steps-up-efforts-to-study-deepfakes/?PostType=link&ServiceType=twitter&TheTime=2021-06-16T16%3A03%3A06&UniqueID=5656784E-CEBC-11EB-BC13-31D94744363C&ftag=COS-05-10aaa0b "CNET") -->

<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Engadget-logo.svg/640px-Engadget-logo.svg.png)](https://www.engadget.com/facebooks-latest-ai-detects-deep-fakes-and-knows-where-they-came-from-160012532.html "Engadget") -->

<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Fortune_magazine_logo_2016.svg/200px-Fortune_magazine_logo_2016.svg.png)](https://fortune.com/2021/06/16/facebook-detecting-deepfakes-research-michigan-state/ "Fortune") -->

<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/Michigan_State_University_wordmark.svg/220px-Michigan_State_University_wordmark.svg.png)](https://msutoday.msu.edu/news/2021/deepfake-detection "MSU") -->


<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c0/New_Scientist_logo.svg/689px-New_Scientist_logo.svg.png)](https://www.newscientist.com/article/2281198-facebook-ai-aims-to-identify-deepfake-images-and-trace-their-creators/ "New Scientist") -->

<!-- [![IMAGE ALT TEXT](https://www.dremio.com/wp-content/uploads/2021/10/sa-logo.png)](https://siliconangle.com/2021/06/16/facebook-reverse-engineering-deepfakes-detect-ai-models-used-create/ "SiliconANGLE") -->

<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/VentureBeat_logo.svg/401px-VentureBeat_logo.svg.png)](https://venturebeat.com/business/facebooks-ai-reverse-engineers-models-used-to-generate-deepfakes/ "VentureBeat") -->

<!-- [![IMAGE ALT TEXT](https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/The_Verge_Logo_2016.svg/220px-The_Verge_Logo_2016.svg.png)](https://www.theverge.com/2021/6/16/22534690/facebook-deepfake-detection-reverse-engineer-ai-model-hyperparameters "The Verge") -->

<!-- [![IMAGE ALT TEXT](https://s.wsj.net/img/meta/wsj-social-share.png)](https://www.wsj.com/articles/facebook-michigan-state-develop-deepfake-detection-technique-11623859200 "The Wall Street Journal") -->

<table style="border-collapse: collapse; border: none;">
  <tr>
    <td style="border: none; ">
      <a href="https://www.cnbc.com/2021/06/16/facebook-scientists-say-they-can-tell-where-deepfakes-come-from.html"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/CNBC_logo.svg/701px-CNBC_logo.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
    <td style="border: none; padding-right: 10px;">
      <a href="https://www.cnet.com/news/privacy/facebook-steps-up-efforts-to-study-deepfakes/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/CNET_%282022%29.svg/220px-CNET_%282022%29.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
  </tr>
  <tr>
    <td style="border: none; ">
      <a href="https://www.engadget.com/facebooks-latest-ai-detects-deep-fakes-and-knows-where-they-came-from-160012532.html"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Engadget-logo.svg/640px-Engadget-logo.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
    <td style="border: none; padding-right: 10px;">
      <a href="https://fortune.com/2021/06/16/facebook-detecting-deepfakes-research-michigan-state/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Fortune_magazine_logo_2016.svg/200px-Fortune_magazine_logo_2016.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
  </tr> 
  <tr>
    <td style="border: none; ">
      <a href="https://fortune.com/2021/06/16/facebook-detecting-deepfakes-research-michigan-state/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Fortune_magazine_logo_2016.svg/200px-Fortune_magazine_logo_2016.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
    <td style="border: none; padding-right: 10px;">
      <a href="https://msutoday.msu.edu/news/2021/deepfake-detection"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/Michigan_State_University_wordmark.svg/220px-Michigan_State_University_wordmark.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
  </tr>
  <tr>
    <td style="border: none; ">
      <a href="https://www.newscientist.com/article/2281198-facebook-ai-aims-to-identify-deepfake-images-and-trace-their-creators/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c0/New_Scientist_logo.svg/689px-New_Scientist_logo.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
    <td style="border: none; padding-right: 10px;">
      <a href="https://siliconangle.com/2021/06/16/facebook-reverse-engineering-deepfakes-detect-ai-models-used-create/"><img src="https://www.dremio.com/wp-content/uploads/2021/10/sa-logo.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
  </tr>
  <tr>
    <td style="border: none; ">
      <a href="https://venturebeat.com/business/facebooks-ai-reverse-engineers-models-used-to-generate-deepfakes/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/VentureBeat_logo.svg/401px-VentureBeat_logo.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
    <td style="border: none; padding-right: 10px;">
      <a href="https://www.theverge.com/2021/6/16/22534690/facebook-deepfake-detection-reverse-engineer-ai-model-hyperparameters/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/The_Verge_Logo_2016.svg/220px-The_Verge_Logo_2016.svg.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
  </tr>
  <tr>
    <td style="border: none; ">
      <a href="https://www.wsj.com/articles/facebook-michigan-state-develop-deepfake-detection-technique-11623859200/"><img src="https://s.wsj.net/img/meta/wsj-social-share.png" height="50px" style="height: 50px !important; width: auto !important;" /></a>
    </td>
  </tr>          
</table>





### BibTex:
{% highlight html %}
{% raw %}
@ARTICLE{asnani2023reverse,
  author={Vishal Asnani and Xi Yin and Tal Hassner and Xiaoming Liu},
  journal={IEEE Transactions on Pattern Analysis and Machine Intelligence},
  title={Reverse engineering of generative models: Inferring model hyperparameters from generated images},
  year={2023},
  URL = {\url{https://talhassner.github.io/home/publication/2023_TPAMI_2}},
  note = {Accepted}
}
{% endraw %}
{% endhighlight %}